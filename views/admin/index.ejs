<!-- Add this to the head of your HTML file -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<%- include('../partials/adminheader') %>

<div class="container">
    <div class="row">
        <div class="col">
            <p class="text-white mt-5 mb-5">Welcome back, <b>Admin</b></p>
        </div>
    </div>
    <div>
        <canvas id="salesChart" width="400" height="200"></canvas>
    </div>
    <script>
        // Sample order data with order dates
        const orderData = [
            { date: '2022-01-05', amount: 500 },
            { date: '2022-02-12', amount: 800 },
            // Add more order data entries as needed
        ];

        // Process order data to get sales for each month
        const salesData = processOrderData(orderData);

        // Get the canvas element
        const salesChartCanvas = document.getElementById('salesChart');

        // Create the sales chart
        const salesChart = new Chart(salesChartCanvas, {
            type: 'bar', // You can use 'line' for a line chart
            data: salesData,
            options: {
                scales: {
                    y: {
                        beginAtZero: true,
                    },
                },
            },
        });

        // Function to process order data and generate sales data for each month
        function processOrderData(orderData) {
            const salesByMonth = {};
            
            // Process each order entry
            orderData.forEach(order => {
                const orderDate = new Date(order.date);
                const monthYear = orderDate.toLocaleString('en-US', { month: 'long', year: 'numeric' });
                const amount = order.amount;

                // Add to or initialize the sales for the month
                if (salesByMonth[monthYear]) {
                    salesByMonth[monthYear] += amount;
                } else {
                    salesByMonth[monthYear] = amount;
                }
            });

            // Convert sales data to Chart.js format
            const chartData = {
                labels: Object.keys(salesByMonth),
                datasets: [{
                    label: 'Monthly Sales',
                    backgroundColor: 'rgba(75, 192, 192, 0.2)', // Adjust the color as needed
                    borderColor: 'rgba(75, 192, 192, 1)', // Adjust the color as needed
                    borderWidth: 1,
                    data: Object.values(salesByMonth),
                }],
            };

            return chartData;
        }
    </script>

<%- include('../partials/adminfooter') %>
